<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nuevo Pr√©stamo</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Overlay de carga -->
    <div id="loader" class="loader hidden">
        <div class="spinner"></div>
        <p>Cargando...</p>
    </div>

    <!-- Pantalla de Enlace Expirado -->
    <div class="expired-screen" id="expired-screen" style="display: none;">
        <div class="expired-content">
            <div class="expired-icon">‚è∞</div>
            <h2 class="expired-title">Este enlace ha expirado</h2>
            <p class="expired-message">
                Para acceder al formulario, solicita un nuevo enlace escribiendo al WhatsApp de PayME.
            </p>
            <div class="expired-help">
                <p class="help-text">¬øNecesitas ayuda? Cont√°ctanos por WhatsApp</p>
            </div>
        </div>
    </div>

    <!-- Pantalla 0: ¬øQu√© tipo de pr√©stamo? -->
    <section id="screen-direction" class="screen active">
        <div class="container">
            <div class="header">
                <button class="btn-back" id="back-to-menu-from-direction">‚Üê</button>
                <h1>¬øQu√© deseas registrar?</h1>
                <p class="subtitle">Selecciona el tipo de pr√©stamo</p>
            </div>

            <div class="content">
                <div class="direction-buttons">
                    <button type="button" class="direction-btn" data-direction="lent">
                        <span class="icon">üí∏</span>
                        <span class="label">Yo prest√©</span>
                        <span class="description">Registra dinero u objetos que prestaste</span>
                    </button>
                    <button type="button" class="direction-btn" data-direction="borrowed">
                        <span class="icon">üì•</span>
                        <span class="label">Me prestaron</span>
                        <span class="description">Registra dinero u objetos que te prestaron</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Pantalla 1: ¬øA qui√©n? -->
    <section id="screen-who" class="screen">
        <div class="container">
            <div class="header">
                <button class="btn-back" id="back-to-menu">‚Üê</button>
                <h1 id="text-who-title">¬øA qui√©n le prestas?</h1>
                <p class="subtitle">Selecciona un contacto o agrega uno nuevo</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 25%"></div>
                </div>
            </div>

            <div class="content">
                <div id="contacts-list" class="contacts-list">
                    <!-- Se llena din√°micamente con JavaScript -->
                </div>

                <button type="button" class="btn-secondary" id="btn-new-contact">
                    <span>‚ûï</span>
                    <span>Agregar nuevo contacto</span>
                </button>
            </div>
        </div>
    </section>

    <!-- Pantalla 2: ¬øQu√©? -->
    <section id="screen-what" class="screen">
        <div class="container">
            <div class="header">
                <button class="btn-back" id="back-from-what">‚Üê</button>
                <h1 id="text-what-title">¬øQu√© le prestas?</h1>
                <p class="subtitle" id="subtitle-what">Selecciona el tipo de pr√©stamo</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 50%"></div>
                </div>
            </div>

            <div class="content">
                <div class="type-buttons">
                    <button type="button" class="type-btn" data-type="money">
                        <span class="icon">üí∞</span>
                        <span class="label">Dinero</span>
                    </button>
                    <button type="button" class="type-btn" data-type="object">
                        <span class="icon">üì¶</span>
                        <span class="label">Un objeto</span>
                    </button>
                </div>

                <div id="detail-input" class="detail-input hidden">
                    <label id="detail-label" for="loan-detail">Monto</label>
                    <input type="text" id="loan-detail" placeholder="Ej: 50000" autocomplete="off">
                    <p class="hint" id="detail-hint">Solo n√∫meros, sin puntos ni comas</p>
                </div>

                <div id="concept-input" class="detail-input hidden">
                    <label for="loan-concept">Concepto del pr√©stamo</label>
                    <input type="text" id="loan-concept" placeholder="Ej: almuerzo, salida con amigos" autocomplete="off">
                    <p class="hint">Describe el prop√≥sito del pr√©stamo (opcional)</p>
                </div>

                <!-- Secci√≥n de imagen opcional -->
                <div id="image-upload-section" class="image-upload-section hidden">
                    <label class="image-upload-label">
                        <span class="label-text">üì∑ Agregar imagen (opcional)</span>
                        <p class="label-hint">Puedes adjuntar una foto del pr√©stamo</p>
                    </label>

                    <div id="image-preview-container" class="image-preview-container hidden">
                        <img id="image-preview" class="image-preview" alt="Preview">
                        <button type="button" class="btn-remove-image" id="btn-remove-image">‚úï</button>
                    </div>

                    <input type="file" id="loan-image" accept="image/jpeg,image/jpg,image/png,image/webp" class="hidden">
                    <button type="button" class="btn-upload-image" id="btn-upload-image">
                        <span>üì∏</span>
                        <span>Seleccionar imagen</span>
                    </button>
                    <p class="upload-hint">M√°ximo 5MB ‚Ä¢ JPG, PNG o WEBP</p>
                </div>

                <button type="button" class="btn-primary hidden" id="btn-continue-what">
                    Continuar
                </button>
            </div>
        </div>
    </section>

    <!-- Pantalla 3: ¬øCu√°ndo? -->
    <section id="screen-when" class="screen">
        <div class="container">
            <div class="header">
                <button class="btn-back" id="back-from-when">‚Üê</button>
                <h1 id="text-when-title">¬øCu√°ndo te lo devuelven?</h1>
                <p class="subtitle">Selecciona una fecha</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%"></div>
                </div>
            </div>

            <div class="content">
                <div class="date-chips">
                    <button type="button" class="date-chip" data-date="tomorrow">
                        <span class="icon">üïê</span>
                        <span class="label">Ma√±ana</span>
                    </button>
                    <button type="button" class="date-chip" data-date="week">
                        <span class="icon">üìÖ</span>
                        <span class="label">En una semana</span>
                    </button>
                    <button type="button" class="date-chip" data-date="month-end">
                        <span class="icon">üìÜ</span>
                        <span class="label">A fin de mes</span>
                    </button>
                    <button type="button" class="date-chip" data-date="custom">
                        <span class="icon">üóìÔ∏è</span>
                        <span class="label">Fecha espec√≠fica</span>
                    </button>
                </div>

                <div id="custom-date-input" class="custom-date-input hidden">
                    <label for="custom-date">Fecha de devoluci√≥n</label>
                    <input type="date" id="custom-date">
                </div>

                <button type="button" class="btn-primary hidden" id="btn-continue-when">
                    Continuar
                </button>
            </div>
        </div>
    </section>

    <!-- Pantalla 4: Confirmaci√≥n -->
    <section id="screen-confirm" class="screen">
        <div class="container">
            <div class="header">
                <button class="btn-back" id="back-from-confirm">‚Üê</button>
                <h1>Confirma el pr√©stamo</h1>
                <p class="subtitle">Verifica que todo est√© correcto</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%"></div>
                </div>
            </div>

            <div class="content">
                <div class="summary-card">
                    <div class="summary-row">
                        <span class="label" id="text-confirm-who-label">Para:</span>
                        <span class="value" id="summary-who">‚Äî</span>
                    </div>
                    <div class="summary-row">
                        <span class="label">Pr√©stamo:</span>
                        <span class="value" id="summary-what">‚Äî</span>
                    </div>
                    <div class="summary-row" id="summary-concept-row" style="display: none;">
                        <span class="label">Concepto:</span>
                        <span class="value" id="summary-concept">‚Äî</span>
                    </div>
                    <div class="summary-row">
                        <span class="label">Devoluci√≥n:</span>
                        <span class="value" id="summary-when">‚Äî</span>
                    </div>
                </div>

                <button type="button" class="btn-primary" id="btn-create-loan">
                    Crear pr√©stamo
                </button>

                <button type="button" class="btn-link" id="btn-edit">
                    Editar
                </button>
            </div>
        </div>
    </section>

    <!-- Pantalla 5: √âxito -->
    <section id="screen-success" class="screen">
        <div class="container">
            <div class="success-animation">
                <div class="checkmark">‚úì</div>
            </div>

            <h1 class="success-title">¬°Pr√©stamo creado!</h1>
            <p class="success-subtitle">El registro se complet√≥ exitosamente</p>

            <div class="success-details">
                <div class="detail-item">
                    <span class="label" id="text-success-who-label">Para:</span>
                    <span class="value" id="success-who">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Pr√©stamo:</span>
                    <span class="value" id="success-what">‚Äî</span>
                </div>
                <div class="detail-item" id="success-concept-row" style="display: none;">
                    <span class="label">Concepto:</span>
                    <span class="value" id="success-concept">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Fecha:</span>
                    <span class="value" id="success-when">‚Äî</span>
                </div>
            </div>

            <button type="button" class="btn-primary" id="btn-create-another">
                Crear otro pr√©stamo
            </button>

            <button type="button" class="btn-secondary" id="btn-back-to-menu-success">
                Volver al men√∫ principal
            </button>
        </div>
    </section>

    <!-- Modal para nuevo contacto -->
    <div id="modal-new-contact" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo contacto</h3>
                <button class="btn-close" id="btn-close-modal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="new-contact-name">Nombre completo *</label>
                    <input type="text" id="new-contact-name" placeholder="Ej: Juan P√©rez" required>
                </div>
                <div class="form-group">
                    <label for="new-contact-phone">Tel√©fono (opcional)</label>
                    <input type="tel" id="new-contact-phone" placeholder="Ej: +56912345678">
                    <p class="hint">Formato: +56912345678</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="btn-cancel-contact">Cancelar</button>
                <button type="button" class="btn-primary" id="btn-save-contact">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Toast de notificaciones -->
    <div id="toast" class="toast hidden">
        <p id="toast-message"></p>
    </div>

    <script src="app.js"></script>
</body>
</html>
