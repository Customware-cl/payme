{
  "version": "7.2",
  "data_api_version": "3.0",
  "routing_model": {
    "LOAN_TYPE_SELECT": ["LOAN_DETAILS"],
    "LOAN_DETAILS": ["CONTACT_SELECT"],
    "CONTACT_SELECT": ["NEW_CONTACT_FORM", "DUE_DATE_SELECT"],
    "NEW_CONTACT_FORM": ["DUE_DATE_SELECT"],
    "DUE_DATE_SELECT": ["SUMMARY_SCREEN"]
  },
  "screens": [
    {
      "id": "LOAN_TYPE_SELECT",
      "title": "Nuevo pr√©stamo",
      "data": {
        "contacts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "main-content": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  }
                }
              },
              "on-click-action": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "next": {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      }
                    }
                  },
                  "payload": {
                    "type": "object"
                  }
                }
              }
            }
          },
          "__example__": [
            {
              "id": "add_new",
              "main-content": {
                "title": "‚ûï Agregar nuevo",
                "description": "Registrar persona nueva"
              },
              "on-click-action": {
                "name": "navigate",
                "next": {
                  "type": "screen",
                  "name": "NEW_CONTACT_FORM"
                },
                "payload": {
                  "loan_type": "money",
                  "loan_detail": "15000"
                }
              }
            }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "type_form",
            "children": [
              {
                "type": "TextHeading",
                "text": "¬øQu√© vas a prestar?"
              },
              {
                "type": "TextCaption",
                "text": "Registra tu pr√©stamo para recibir recordatorios autom√°ticos üëá"
              },
              {
                "type": "RadioButtonsGroup",
                "name": "loan_type",
                "label": "Tipo de pr√©stamo",
                "required": true,
                "data-source": [
                  {
                    "id": "money",
                    "title": "üí∞ Dinero"
                  },
                  {
                    "id": "object",
                    "title": "üì¶ Un objeto"
                  },
                  {
                    "id": "other",
                    "title": "‚úèÔ∏è Otra cosa"
                  }
                ]
              },
              {
                "type": "Footer",
                "label": "Continuar",
                "on-click-action": {
                  "name": "navigate",
                  "next": {
                    "type": "screen",
                    "name": "LOAN_DETAILS"
                  },
                  "payload": {
                    "loan_type": "${form.loan_type}",
                    "contacts": "${data.contacts}"
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "LOAN_DETAILS",
      "title": "Nuevo pr√©stamo",
      "data": {
        "loan_type": {
          "type": "string",
          "__example__": "money"
        },
        "contacts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "main-content": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  }
                }
              },
              "on-click-action": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "next": {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      }
                    }
                  },
                  "payload": {
                    "type": "object"
                  }
                }
              }
            }
          },
          "__example__": [
            {
              "id": "add_new",
              "main-content": {
                "title": "‚ûï Agregar nuevo",
                "description": "Registrar persona nueva"
              },
              "on-click-action": {
                "name": "navigate",
                "next": {
                  "type": "screen",
                  "name": "NEW_CONTACT_FORM"
                },
                "payload": {
                  "loan_type": "money",
                  "loan_detail": "15000"
                }
              }
            }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "details_form",
            "children": [
              {
                "type": "TextHeading",
                "text": "Detalles del pr√©stamo"
              },
              {
                "type": "TextInput",
                "name": "loan_detail",
                "label": "Monto u objeto",
                "input-type": "text",
                "required": true,
                "helper-text": "Ingresa el monto (ej: 15000) o describe el objeto (ej: Taladro Bosch)"
              },
              {
                "type": "Footer",
                "label": "Continuar",
                "on-click-action": {
                  "name": "navigate",
                  "next": {
                    "type": "screen",
                    "name": "CONTACT_SELECT"
                  },
                  "payload": {
                    "loan_type": "${data.loan_type}",
                    "loan_detail": "${form.loan_detail}",
                    "contacts": "${data.contacts}"
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "CONTACT_SELECT",
      "title": "Seleccionar contacto",
      "data": {
        "loan_type": {
          "type": "string",
          "__example__": "money"
        },
        "loan_detail": {
          "type": "string",
          "__example__": "15000"
        },
        "contacts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "main-content": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  }
                }
              },
              "on-click-action": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "next": {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      }
                    }
                  },
                  "payload": {
                    "type": "object"
                  }
                }
              }
            }
          },
          "__example__": [
            {
              "id": "add_new",
              "main-content": {
                "title": "‚ûï Agregar nuevo",
                "description": "Registrar persona nueva"
              },
              "on-click-action": {
                "name": "navigate",
                "next": {
                  "type": "screen",
                  "name": "NEW_CONTACT_FORM"
                },
                "payload": {
                  "loan_type": "money",
                  "loan_detail": "15000"
                }
              }
            },
            {
              "id": "contact_123",
              "main-content": {
                "title": "Juan P√©rez",
                "description": "912345678"
              },
              "on-click-action": {
                "name": "navigate",
                "next": {
                  "type": "screen",
                  "name": "DUE_DATE_SELECT"
                },
                "payload": {
                  "loan_type": "money",
                  "loan_detail": "15000",
                  "contact_id": "contact_123",
                  "contact_name": "Juan P√©rez",
                  "contact_phone": "+56912345678",
                  "new_contact": false
                }
              }
            }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "contacts_form",
            "children": [
              {
                "type": "NavigationList",
                "name": "contacts_list",
                "label": "¬øA qui√©n le vas a prestar?",
                "list-items": "${data.contacts}"
              }
            ]
          }
        ]
      }
    },
    {
      "id": "NEW_CONTACT_FORM",
      "title": "Nuevo pr√©stamo",
      "data": {
        "loan_type": {
          "type": "string",
          "__example__": "money"
        },
        "loan_detail": {
          "type": "string",
          "__example__": "15000"
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "contact_form",
            "children": [
              {
                "type": "TextHeading",
                "text": "Nuevo contacto"
              },
              {
                "type": "TextCaption",
                "text": "Agrega los datos para crear el contacto"
              },
              {
                "type": "TextInput",
                "name": "contact_name",
                "label": "Nombre completo",
                "input-type": "text",
                "required": true,
                "helper-text": "Usa el nombre que usas normalmente para esta persona"
              },
              {
                "type": "TextInput",
                "name": "contact_phone",
                "label": "Tel√©fono (opcional)",
                "input-type": "phone",
                "required": false,
                "helper-text": "Incluye +56 9 para enviar recordatorios por WhatsApp"
              },
              {
                "type": "Footer",
                "label": "Guardar contacto",
                "on-click-action": {
                  "name": "navigate",
                  "next": {
                    "type": "screen",
                    "name": "DUE_DATE_SELECT"
                  },
                  "payload": {
                    "loan_type": "${data.loan_type}",
                    "loan_detail": "${data.loan_detail}",
                    "contact_name": "${form.contact_name}",
                    "contact_phone": "${form.contact_phone}",
                    "new_contact": true
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "DUE_DATE_SELECT",
      "title": "Nuevo pr√©stamo",
      "data": {
        "loan_type": {
          "type": "string",
          "__example__": "money"
        },
        "loan_detail": {
          "type": "string",
          "__example__": "15000"
        },
        "contact_id": {
          "type": "string",
          "__example__": ""
        },
        "contact_name": {
          "type": "string",
          "__example__": "Juan P√©rez"
        },
        "contact_phone": {
          "type": "string",
          "__example__": ""
        },
        "new_contact": {
          "type": "boolean",
          "__example__": false
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "date_form",
            "children": [
              {
                "type": "TextHeading",
                "text": "¬øCu√°ndo debe devolv√©rtelo?"
              },
              {
                "type": "TextCaption",
                "text": "Te enviaremos un recordatorio en esa fecha üîî"
              },
              {
                "type": "RadioButtonsGroup",
                "name": "date_option",
                "label": "Fecha devoluci√≥n",
                "required": true,
                "data-source": [
                  {
                    "id": "tomorrow",
                    "title": "üóìÔ∏è Ma√±ana"
                  },
                  {
                    "id": "end_of_month",
                    "title": "üìÖ Fin de mes"
                  }
                ]
              },
              {
                "type": "Footer",
                "label": "Continuar",
                "on-click-action": {
                  "name": "navigate",
                  "next": {
                    "type": "screen",
                    "name": "SUMMARY_SCREEN"
                  },
                  "payload": {
                    "loan_type": "${data.loan_type}",
                    "loan_detail": "${data.loan_detail}",
                    "contact_id": "${data.contact_id}",
                    "contact_name": "${data.contact_name}",
                    "contact_phone": "${data.contact_phone}",
                    "new_contact": "${data.new_contact}",
                    "date_option": "${form.date_option}"
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "SUMMARY_SCREEN",
      "title": "Nuevo pr√©stamo",
      "terminal": true,
      "data": {
        "loan_type": {
          "type": "string",
          "__example__": "money"
        },
        "loan_detail": {
          "type": "string",
          "__example__": "15000"
        },
        "contact_id": {
          "type": "string",
          "__example__": ""
        },
        "contact_name": {
          "type": "string",
          "__example__": "Juan P√©rez"
        },
        "contact_phone": {
          "type": "string",
          "__example__": ""
        },
        "new_contact": {
          "type": "boolean",
          "__example__": false
        },
        "date_option": {
          "type": "string",
          "__example__": "tomorrow"
        },
        "formatted_what": {
          "type": "string",
          "__example__": "$15.000"
        },
        "formatted_when": {
          "type": "string",
          "__example__": "Ma√±ana (7 Oct)"
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "summary_form",
            "children": [
              {
                "type": "TextHeading",
                "text": "‚úÖ Confirma tu pr√©stamo"
              },
              {
                "type": "TextCaption",
                "text": "Revisa que todo est√© correcto antes de guardar"
              },
              {
                "type": "TextBody",
                "text": "üìù Resumen del pr√©stamo:\n\nüí∞ Qu√©: ${data.formatted_what}\n\nüë§ Qui√©n: ${data.contact_name}\n\nüìÖ Cu√°ndo: ${data.formatted_when}"
              },
              {
                "type": "TextCaption",
                "text": "üí° Recibir√°s un recordatorio en la fecha acordada"
              },
              {
                "type": "Footer",
                "label": "Crear pr√©stamo",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "loan_type": "${data.loan_type}",
                    "loan_detail": "${data.loan_detail}",
                    "contact_id": "${data.contact_id}",
                    "contact_name": "${data.contact_name}",
                    "contact_phone": "${data.contact_phone}",
                    "new_contact": "${data.new_contact}",
                    "date_option": "${data.date_option}"
                  }
                }
              }
            ]
          }
        ]
      }
    }
  ]
}
